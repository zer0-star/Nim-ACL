---
data:
  _extendedDependsOn:
  - icon: ':question:'
    path: atcoder/convolution.nim
    title: atcoder/convolution.nim
  - icon: ':question:'
    path: atcoder/convolution.nim
    title: atcoder/convolution.nim
  - icon: ':question:'
    path: atcoder/convolution.nim
    title: atcoder/convolution.nim
  - icon: ':question:'
    path: atcoder/convolution.nim
    title: atcoder/convolution.nim
  - icon: ':question:'
    path: atcoder/element_concepts.nim
    title: atcoder/element_concepts.nim
  - icon: ':question:'
    path: atcoder/element_concepts.nim
    title: atcoder/element_concepts.nim
  - icon: ':question:'
    path: atcoder/element_concepts.nim
    title: atcoder/element_concepts.nim
  - icon: ':question:'
    path: atcoder/element_concepts.nim
    title: atcoder/element_concepts.nim
  - icon: ':question:'
    path: atcoder/extra/math/arbitrary_mod_convolution.nim
    title: atcoder/extra/math/arbitrary_mod_convolution.nim
  - icon: ':question:'
    path: atcoder/extra/math/arbitrary_mod_convolution.nim
    title: atcoder/extra/math/arbitrary_mod_convolution.nim
  - icon: ':question:'
    path: atcoder/extra/math/arbitrary_mod_convolution.nim
    title: atcoder/extra/math/arbitrary_mod_convolution.nim
  - icon: ':question:'
    path: atcoder/extra/math/arbitrary_mod_convolution.nim
    title: atcoder/extra/math/arbitrary_mod_convolution.nim
  - icon: ':warning:'
    path: atcoder/extra/math/characteristic_polynomial.nim
    title: atcoder/extra/math/characteristic_polynomial.nim
  - icon: ':warning:'
    path: atcoder/extra/math/characteristic_polynomial.nim
    title: atcoder/extra/math/characteristic_polynomial.nim
  - icon: ':warning:'
    path: atcoder/extra/math/characteristic_polynomial.nim
    title: atcoder/extra/math/characteristic_polynomial.nim
  - icon: ':warning:'
    path: atcoder/extra/math/characteristic_polynomial.nim
    title: atcoder/extra/math/characteristic_polynomial.nim
  - icon: ':question:'
    path: atcoder/extra/math/formal_power_series.nim
    title: atcoder/extra/math/formal_power_series.nim
  - icon: ':question:'
    path: atcoder/extra/math/formal_power_series.nim
    title: atcoder/extra/math/formal_power_series.nim
  - icon: ':question:'
    path: atcoder/extra/math/formal_power_series.nim
    title: atcoder/extra/math/formal_power_series.nim
  - icon: ':question:'
    path: atcoder/extra/math/formal_power_series.nim
    title: atcoder/extra/math/formal_power_series.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/math/matrix.nim
    title: atcoder/extra/math/matrix.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/math/matrix.nim
    title: atcoder/extra/math/matrix.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/math/matrix.nim
    title: atcoder/extra/math/matrix.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/math/matrix.nim
    title: atcoder/extra/math/matrix.nim
  - icon: ':question:'
    path: atcoder/extra/math/ntt.nim
    title: atcoder/extra/math/ntt.nim
  - icon: ':question:'
    path: atcoder/extra/math/ntt.nim
    title: atcoder/extra/math/ntt.nim
  - icon: ':question:'
    path: atcoder/extra/math/ntt.nim
    title: atcoder/extra/math/ntt.nim
  - icon: ':question:'
    path: atcoder/extra/math/ntt.nim
    title: atcoder/extra/math/ntt.nim
  - icon: ':question:'
    path: atcoder/extra/math/particular_mod_convolution.nim
    title: atcoder/extra/math/particular_mod_convolution.nim
  - icon: ':question:'
    path: atcoder/extra/math/particular_mod_convolution.nim
    title: atcoder/extra/math/particular_mod_convolution.nim
  - icon: ':question:'
    path: atcoder/extra/math/particular_mod_convolution.nim
    title: atcoder/extra/math/particular_mod_convolution.nim
  - icon: ':question:'
    path: atcoder/extra/math/particular_mod_convolution.nim
    title: atcoder/extra/math/particular_mod_convolution.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/other/operator.nim
    title: atcoder/extra/other/operator.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/other/operator.nim
    title: atcoder/extra/other/operator.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/other/operator.nim
    title: atcoder/extra/other/operator.nim
  - icon: ':heavy_check_mark:'
    path: atcoder/extra/other/operator.nim
    title: atcoder/extra/other/operator.nim
  - icon: ':question:'
    path: atcoder/generate_definitions.nim
    title: atcoder/generate_definitions.nim
  - icon: ':question:'
    path: atcoder/generate_definitions.nim
    title: atcoder/generate_definitions.nim
  - icon: ':question:'
    path: atcoder/generate_definitions.nim
    title: atcoder/generate_definitions.nim
  - icon: ':question:'
    path: atcoder/generate_definitions.nim
    title: atcoder/generate_definitions.nim
  - icon: ':question:'
    path: atcoder/internal_bit.nim
    title: atcoder/internal_bit.nim
  - icon: ':question:'
    path: atcoder/internal_bit.nim
    title: atcoder/internal_bit.nim
  - icon: ':question:'
    path: atcoder/internal_bit.nim
    title: atcoder/internal_bit.nim
  - icon: ':question:'
    path: atcoder/internal_bit.nim
    title: atcoder/internal_bit.nim
  - icon: ':question:'
    path: atcoder/internal_math.nim
    title: atcoder/internal_math.nim
  - icon: ':question:'
    path: atcoder/internal_math.nim
    title: atcoder/internal_math.nim
  - icon: ':question:'
    path: atcoder/internal_math.nim
    title: atcoder/internal_math.nim
  - icon: ':question:'
    path: atcoder/internal_math.nim
    title: atcoder/internal_math.nim
  - icon: ':question:'
    path: atcoder/modint.nim
    title: atcoder/modint.nim
  - icon: ':question:'
    path: atcoder/modint.nim
    title: atcoder/modint.nim
  - icon: ':question:'
    path: atcoder/modint.nim
    title: atcoder/modint.nim
  - icon: ':question:'
    path: atcoder/modint.nim
    title: atcoder/modint.nim
  _extendedRequiredBy: []
  _extendedVerifiedWith: []
  _isVerificationFailed: false
  _pathExtension: nim
  _verificationStatusIcon: ':warning:'
  attributes:
    links: []
  bundledCode: "Traceback (most recent call last):\n  File \"/opt/hostedtoolcache/Python/3.10.8/x64/lib/python3.10/site-packages/onlinejudge_verify/documentation/build.py\"\
    , line 71, in _render_source_code_stat\n    bundled_code = language.bundle(stat.path,\
    \ basedir=basedir, options={'include_paths': [basedir]}).decode()\n  File \"/opt/hostedtoolcache/Python/3.10.8/x64/lib/python3.10/site-packages/onlinejudge_verify/languages/nim.py\"\
    , line 86, in bundle\n    raise NotImplementedError\nNotImplementedError\n"
  code: "when not declared ATCODER_KITAMASA_HPP:\n  const ATCODER_KITAMASA_HPP* =\
    \ 1\n\n  import atcoder/extra/math/ntt\n  import atcoder/extra/math/formal_power_series\n\
    \  import atcoder/extra/math/matrix\n  import atcoder/extra/math/characteristic_polynomial\n\
    \n  proc kitamasa*[M:SomeMatrix](A:M, b:M.Vector, k:int):M.Vector =\n    # A^n\
    \ * b\u3092\u9AD8\u901F\u306B\u8A08\u7B97\u3059\u308B\n    var c = initFormalPowerSeries[M.T](A.characteristicPolynomial())\n\
    \    let n = A.height\n    var\n      k = k\n      a, p = initFormalPowerSeries[M.T](n)\n\
    \    p[0] = 1\n    a[1] = 1\n    while k > 0:\n      if k mod 2 == 1:\n      \
    \  p = p * a mod c\n      k = k div 2\n      a = a * a mod c\n    result = M.initVector(n)\n\
    \    block:\n      var b = b\n      for t in p:\n        for i in 0 ..< n:\n \
    \         result[i] += b[i] * t\n        b = A * b\n"
  dependsOn:
  - atcoder/extra/other/operator.nim
  - atcoder/internal_bit.nim
  - atcoder/convolution.nim
  - atcoder/generate_definitions.nim
  - atcoder/internal_math.nim
  - atcoder/extra/math/particular_mod_convolution.nim
  - atcoder/extra/math/ntt.nim
  - atcoder/extra/math/particular_mod_convolution.nim
  - atcoder/element_concepts.nim
  - atcoder/extra/math/ntt.nim
  - atcoder/internal_bit.nim
  - atcoder/convolution.nim
  - atcoder/modint.nim
  - atcoder/extra/math/formal_power_series.nim
  - atcoder/extra/math/characteristic_polynomial.nim
  - atcoder/modint.nim
  - atcoder/extra/math/formal_power_series.nim
  - atcoder/extra/math/arbitrary_mod_convolution.nim
  - atcoder/extra/math/characteristic_polynomial.nim
  - atcoder/extra/math/arbitrary_mod_convolution.nim
  - atcoder/generate_definitions.nim
  - atcoder/extra/math/matrix.nim
  - atcoder/internal_math.nim
  - atcoder/extra/math/matrix.nim
  - atcoder/element_concepts.nim
  - atcoder/extra/other/operator.nim
  - atcoder/extra/other/operator.nim
  - atcoder/internal_bit.nim
  - atcoder/convolution.nim
  - atcoder/generate_definitions.nim
  - atcoder/internal_math.nim
  - atcoder/extra/math/particular_mod_convolution.nim
  - atcoder/extra/math/ntt.nim
  - atcoder/extra/math/particular_mod_convolution.nim
  - atcoder/element_concepts.nim
  - atcoder/extra/math/ntt.nim
  - atcoder/internal_bit.nim
  - atcoder/convolution.nim
  - atcoder/modint.nim
  - atcoder/extra/math/formal_power_series.nim
  - atcoder/extra/math/characteristic_polynomial.nim
  - atcoder/modint.nim
  - atcoder/extra/math/formal_power_series.nim
  - atcoder/extra/math/arbitrary_mod_convolution.nim
  - atcoder/extra/math/characteristic_polynomial.nim
  - atcoder/extra/math/arbitrary_mod_convolution.nim
  - atcoder/generate_definitions.nim
  - atcoder/extra/math/matrix.nim
  - atcoder/internal_math.nim
  - atcoder/extra/math/matrix.nim
  - atcoder/element_concepts.nim
  - atcoder/extra/other/operator.nim
  isVerificationFile: false
  path: atcoder/extra/math/kitamasa.nim
  requiredBy: []
  timestamp: '2022-10-23 18:37:31+09:00'
  verificationStatus: LIBRARY_NO_TESTS
  verifiedWith: []
documentation_of: atcoder/extra/math/kitamasa.nim
layout: document
redirect_from:
- /library/atcoder/extra/math/kitamasa.nim
- /library/atcoder/extra/math/kitamasa.nim.html
title: atcoder/extra/math/kitamasa.nim
---
